<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width" />
  <title>Visual Markdown Editor</title>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    window.MathJax = {
      tex: { inlineMath: [['$', '$']], displayMath: [['$$', '$$']] },
      svg: { fontCache: 'global' }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
  <style>
    html, body { margin: 0; height: 100%; font-family: sans-serif; }
    #editor { height: 50%; padding: 16px; overflow-y: auto; border-bottom: 1px solid #ccc; }
    #editor[contenteditable] { outline: none; background: #eef; }
    #toolbar { padding: 8px; background: #ddd; white-space: nowrap; overflow-x: auto; }
    #toolbar button { margin-right: 8px; padding: 6px 12px; background: #444; color: #fff; border: none; border-radius: 4px; cursor: pointer; }
    #output { height: 50%; padding: 12px; overflow-y: auto; background: #fff0f5; }
    img { max-width: 100%; margin: 8px 0; }
  </style>
</head>
<body>

<div id="toolbar">
  <button onclick="insertImage()">üñºÔ∏è Insert Image</button>
  <button onclick="renderPreview()">üîÑ Preview</button>
</div>

<div id="editor" contenteditable="true">
  <h3>Start writing‚Ä¶</h3>
  <p>You can insert images directly.</p>
</div>

<div id="output"></div>

<script>
  const editor = document.getElementById("editor");
  const output = document.getElementById("output");

  function insertImage() {
    const input = document.createElement("input");
    input.type = "file";
    input.accept = "image/*";
    input.style.display = "none";
    input.onchange = (e) => {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = evt => {
          const img = document.createElement("img");
          img.src = evt.target.result;
          img.alt = "Image";
          editor.appendChild(img);
        };
        reader.readAsDataURL(file);
      }
    };
    document.body.appendChild(input);
    input.click();
  }

  function renderPreview() {
    const raw = editor.innerHTML;
    const html = marked.parse(raw, { breaks: true });
    output.innerHTML = html;
    MathJax.typesetClear();
    MathJax.typesetPromise([output]);
  }
</script>

</body>
</html>